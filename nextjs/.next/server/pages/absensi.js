"use strict";(()=>{var e={};e.id=7570,e.ids=[7570],e.modules={6127:(e,a,s)=>{s.a(e,async(e,t)=>{try{s.r(a),s.d(a,{config:()=>h,default:()=>o,getServerSideProps:()=>g,getStaticPaths:()=>x,getStaticProps:()=>u,reportWebVitals:()=>p,routeModule:()=>w,unstable_getServerProps:()=>f,unstable_getServerSideProps:()=>k,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>b,unstable_getStaticProps:()=>j});var r=s(7093),i=s(5244),n=s(1323),l=s(7645),d=s(6814),c=s(9095),m=e([d,c]);[d,c]=m.then?(await m)():m;let o=(0,n.l)(c,"default"),u=(0,n.l)(c,"getStaticProps"),x=(0,n.l)(c,"getStaticPaths"),g=(0,n.l)(c,"getServerSideProps"),h=(0,n.l)(c,"config"),p=(0,n.l)(c,"reportWebVitals"),j=(0,n.l)(c,"unstable_getStaticProps"),b=(0,n.l)(c,"unstable_getStaticPaths"),v=(0,n.l)(c,"unstable_getStaticParams"),f=(0,n.l)(c,"unstable_getServerProps"),k=(0,n.l)(c,"unstable_getServerSideProps"),w=new r.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/absensi",pathname:"/absensi",bundlePath:"",filename:""},components:{App:d.default,Document:l.default},userland:c});t()}catch(e){t(e)}})},8484:(e,a,s)=>{},9095:(e,a,s)=>{s.a(e,async(e,t)=>{try{s.r(a),s.d(a,{default:()=>y});var r=s(997),i=s(6689),n=s(968),l=s.n(n),d=s(9314),c=s(1163),m=s(8484),o=s(9948),u=s(6250),x=s(9767),g=s(3749),h=s(4535),p=s(3054),j=s(9269),b=s(6048),v=s(1386),f=s(8617),k=s(1140),w=e([u,x]);[u,x]=w.then?(await w)():w;let y=()=>{let{user:e,isAuthenticated:a,isLoading:s}=(0,d.a)(),t=(0,c.useRouter)(),{addToast:n}=(0,o.p)(),[w,y]=(0,i.useState)(null),[N,S]=(0,i.useState)([]),[_,Z]=(0,i.useState)(!0),[E,P]=(0,i.useState)(!1),[L,A]=(0,i.useState)(!1),[M,I]=(0,i.useState)(new Date),[C,D]=(0,i.useState)(null),[q,B]=(0,i.useState)("");(0,i.useEffect)(()=>{s||a||t.push("/login")},[a,s,t]),(0,i.useEffect)(()=>{a&&(O(),R(),z())},[a]),(0,i.useEffect)(()=>{let e=setInterval(()=>{I(new Date)},1e3);return()=>clearInterval(e)},[]);let z=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{D({lat:e.coords.latitude,lng:e.coords.longitude}),B("")},e=>{B("Gagal mendapatkan lokasi. Pastikan GPS aktif.")}):B("Browser tidak mendukung geolocation.")},O=async()=>{try{let e=new Date().toISOString().split("T")[0],a=await m.absensiApi.getByDate(e);a.success&&a.data?y(a.data):y(null)}catch(s){let a=new Date().toISOString().split("T")[0];"2024-01-15"===a?y({id:1,user_id:e?.id||1,tanggal:a,jam_masuk:"08:00:00",jam_keluar:void 0,status:"hadir",keterangan:"",created_at:"2024-01-15 08:00:00",updated_at:"2024-01-15 08:00:00"}):y(null)}},R=async()=>{try{Z(!0);let a=await m.absensiApi.getMyAttendance({limit:7});a.success&&a.data?S(a.data.data||[]):S([{id:1,user_id:e?.id||1,tanggal:"2024-01-15",jam_masuk:"08:00:00",jam_keluar:"17:00:00",status:"hadir",keterangan:"",created_at:"2024-01-15 08:00:00",updated_at:"2024-01-15 17:00:00"},{id:2,user_id:e?.id||1,tanggal:"2024-01-14",jam_masuk:"08:30:00",jam_keluar:"17:00:00",status:"terlambat",keterangan:"Terlambat 30 menit",created_at:"2024-01-14 08:30:00",updated_at:"2024-01-14 17:00:00"},{id:3,user_id:e?.id||1,tanggal:"2024-01-13",jam_masuk:void 0,jam_keluar:void 0,status:"tidak_hadir",keterangan:"Tidak hadir tanpa keterangan",created_at:"2024-01-13 00:00:00",updated_at:"2024-01-13 00:00:00"}])}catch(e){n({type:"error",title:"Error",message:e.message||"Gagal memuat riwayat absensi"})}finally{Z(!1)}},W=async()=>{if(!C){n({type:"error",title:"Error",message:"Lokasi diperlukan untuk absen masuk"});return}try{P(!0);let e=await m.absensiApi.clockIn({latitude:C.lat,longitude:C.lng});if(e.success)n({type:"success",title:"Berhasil",message:"Absen masuk berhasil dicatat"}),O(),R();else throw Error(e.message)}catch(e){n({type:"error",title:"Error",message:e.message||"Gagal melakukan absen masuk"})}finally{P(!1)}},G=async()=>{if(!C){n({type:"error",title:"Error",message:"Lokasi diperlukan untuk absen keluar"});return}try{A(!0);let e=await m.absensiApi.clockOut({latitude:C.lat,longitude:C.lng});if(e.success)n({type:"success",title:"Berhasil",message:"Absen keluar berhasil dicatat"}),O(),R();else throw Error(e.message)}catch(e){n({type:"error",title:"Error",message:e.message||"Gagal melakukan absen keluar"})}finally{A(!1)}},T=e=>{switch(e){case"hadir":return(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-success-100 text-success-800",children:[r.jsx(g.Z,{className:"h-3 w-3 mr-1"}),"Hadir"]});case"terlambat":return(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-warning-100 text-warning-800",children:[r.jsx(h.Z,{className:"h-3 w-3 mr-1"}),"Terlambat"]});case"alpha":return(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-danger-100 text-danger-800",children:[r.jsx(p.Z,{className:"h-3 w-3 mr-1"}),"Alpha"]});case"izin":return(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[r.jsx(g.Z,{className:"h-3 w-3 mr-1"}),"Izin"]});case"sakit":return(0,r.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[r.jsx(g.Z,{className:"h-3 w-3 mr-1"}),"Sakit"]});default:return r.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e})}},F=e=>new Date(e).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),H=e=>e?e.substring(0,5):"-";return s||!a?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx("div",{className:"loading-spinner w-8 h-8"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l(),{children:[r.jsx("title",{children:"Absensi - AFMS"}),r.jsx("meta",{name:"description",content:"Sistem absensi karyawan"})]}),r.jsx(u.Z,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-white shadow-sm rounded-lg p-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:["Selamat Datang, ",e?.nama_pegawai]}),r.jsx("p",{className:"text-gray-600 mt-1",children:M.toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),r.jsx("div",{className:"text-3xl font-mono font-bold text-primary-600 mt-2",children:M.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})}),r.jsx("div",{className:"bg-white shadow-sm rounded-lg p-6",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Absensi Hari Ini"}),q&&(0,r.jsxs)("div",{className:"mb-4 p-3 bg-warning-50 border border-warning-200 rounded-md",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(h.Z,{className:"h-5 w-5 text-warning-400 mr-2"}),r.jsx("span",{className:"text-sm text-warning-700",children:q})]}),r.jsx(x.z,{variant:"outline",size:"sm",onClick:z,className:"mt-2",leftIcon:r.jsx(j.Z,{className:"h-4 w-4"}),children:"Coba Lagi"})]}),C&&r.jsx("div",{className:"mb-4 p-3 bg-success-50 border border-success-200 rounded-md",children:(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[r.jsx(j.Z,{className:"h-5 w-5 text-success-400 mr-2"}),(0,r.jsxs)("span",{className:"text-sm text-success-700",children:["Lokasi terdeteksi: ",C.lat.toFixed(6),", ",C.lng.toFixed(6)]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-w-md mx-auto",children:[w?.jam_masuk?r.jsx("div",{className:"h-20 bg-success-50 border-2 border-success-200 rounded-lg flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(g.Z,{className:"h-6 w-6 text-success-600 mx-auto mb-1"}),(0,r.jsxs)("div",{className:"text-sm font-medium text-success-800",children:["Masuk: ",H(w.jam_masuk)]})]})}):r.jsx(x.z,{onClick:W,loading:E,disabled:!C,size:"lg",className:"h-20",leftIcon:r.jsx(b.Z,{className:"h-6 w-6"}),children:(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-semibold",children:"Absen Masuk"}),r.jsx("div",{className:"text-sm opacity-75",children:"Clock In"})]})}),w?.jam_masuk&&!w?.jam_keluar?r.jsx(x.z,{onClick:G,loading:L,disabled:!C,variant:"destructive",size:"lg",className:"h-20",leftIcon:r.jsx(v.Z,{className:"h-6 w-6"}),children:(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-semibold",children:"Absen Keluar"}),r.jsx("div",{className:"text-sm opacity-75",children:"Clock Out"})]})}):w?.jam_keluar?r.jsx("div",{className:"h-20 bg-danger-50 border-2 border-danger-200 rounded-lg flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(g.Z,{className:"h-6 w-6 text-danger-600 mx-auto mb-1"}),(0,r.jsxs)("div",{className:"text-sm font-medium text-danger-800",children:["Keluar: ",H(w.jam_keluar)]})]})}):r.jsx("div",{className:"h-20 bg-gray-50 border-2 border-gray-200 rounded-lg flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center text-gray-500",children:[r.jsx(f.Z,{className:"h-6 w-6 mx-auto mb-1"}),r.jsx("div",{className:"text-sm",children:"Belum Absen Masuk"})]})})]}),w&&(0,r.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-4",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Status Hari Ini:"}),T(w.status)]}),w.keterangan&&(0,r.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:["Keterangan: ",w.keterangan]})]})]})}),(0,r.jsxs)("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Riwayat Absensi"})}),_?r.jsx("div",{className:"p-6",children:r.jsx("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,a)=>r.jsx("div",{className:"animate-pulse",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"h-10 w-10 bg-gray-200 rounded-lg"}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded w-32 mb-2"}),r.jsx("div",{className:"h-3 bg-gray-200 rounded w-24"})]})]}),r.jsx("div",{className:"h-6 w-16 bg-gray-200 rounded"})]})},a))})}):r.jsx("div",{className:"divide-y divide-gray-200",children:0===N.length?r.jsx("div",{className:"p-6 text-center text-gray-500",children:"Belum ada riwayat absensi"}):N.map(e=>r.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[r.jsx("div",{className:"h-10 w-10 bg-primary-100 rounded-lg flex items-center justify-center",children:r.jsx(k.Z,{className:"h-5 w-5 text-primary-600"})}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:F(e.tanggal)}),(0,r.jsxs)("div",{className:"text-sm text-gray-500 flex items-center space-x-4",children:[(0,r.jsxs)("span",{className:"flex items-center",children:[r.jsx(f.Z,{className:"h-3 w-3 mr-1"}),"Masuk: ",H(e.jam_masuk)]}),(0,r.jsxs)("span",{className:"flex items-center",children:[r.jsx(f.Z,{className:"h-3 w-3 mr-1"}),"Keluar: ",H(e.jam_keluar)]})]})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[T(e.status),e.keterangan&&r.jsx("div",{className:"text-xs text-gray-500 mt-1",children:e.keterangan})]})]})},e.id))})]})]})})]})};t()}catch(e){t(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")},9752:e=>{e.exports=import("@tanstack/react-query")},6926:e=>{e.exports=import("class-variance-authority")},1386:(e,a,s)=>{s.d(a,{Z:()=>r});var t=s(6689);let r=t.forwardRef(function({title:e,titleId:a,...s},r){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":a},s),e?t.createElement("title",{id:a},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15M12 9l-3 3m0 0 3 3m-3-3h12.75"}))})},3749:(e,a,s)=>{s.d(a,{Z:()=>r});var t=s(6689);let r=t.forwardRef(function({title:e,titleId:a,...s},r){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":a},s),e?t.createElement("title",{id:a},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))})},4535:(e,a,s)=>{s.d(a,{Z:()=>r});var t=s(6689);let r=t.forwardRef(function({title:e,titleId:a,...s},r){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":a},s),e?t.createElement("title",{id:a},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))})},9269:(e,a,s)=>{s.d(a,{Z:()=>r});var t=s(6689);let r=t.forwardRef(function({title:e,titleId:a,...s},r){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":a},s),e?t.createElement("title",{id:a},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))})},3054:(e,a,s)=>{s.d(a,{Z:()=>r});var t=s(6689);let r=t.forwardRef(function({title:e,titleId:a,...s},r){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":a},s),e?t.createElement("title",{id:a},e):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))})}};var a=require("../webpack-runtime.js");a.C(e);var s=e=>a(a.s=e),t=a.X(0,[6859,8342,7890,1557],()=>s(6127));module.exports=t})();