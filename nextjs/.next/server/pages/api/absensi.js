"use strict";(()=>{var a={};a.id=4404,a.ids=[4404],a.modules={145:a=>{a.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(a,e)=>{Object.defineProperty(e,"l",{enumerable:!0,get:function(){return function a(e,t){return t in e?e[t]:"then"in e&&"function"==typeof e.then?e.then(e=>a(e,t)):"function"==typeof e&&"default"===t?e:void 0}}})},5905:(a,e,t)=>{t.r(e),t.d(e,{config:()=>c,default:()=>m,routeModule:()=>k});var r={};t.r(r),t.d(r,{default:()=>d});var n=t(1802),s=t(7153),u=t(6249);!function(){var a=Error("Cannot find module '../../../lib/auth-middleware'");throw a.code="MODULE_NOT_FOUND",a}();let i=[{id:1,karyawan_id:1,karyawan:{nama:"John Doe",email:"john@afms.com"},tanggal:"2024-01-15",jam_masuk:"08:00:00",jam_keluar:"17:00:00",status:"hadir",keterangan:"",lokasi_masuk:"Kantor Utama",lokasi_keluar:"Kantor Utama",created_at:"2024-01-15T08:00:00.000Z",updated_at:"2024-01-15T17:00:00.000Z"},{id:2,karyawan_id:2,karyawan:{nama:"Jane Smith",email:"jane@afms.com"},tanggal:"2024-01-15",jam_masuk:"08:15:00",jam_keluar:"17:00:00",status:"terlambat",keterangan:"Terlambat 15 menit",lokasi_masuk:"Kantor Utama",lokasi_keluar:"Kantor Utama",created_at:"2024-01-15T08:15:00.000Z",updated_at:"2024-01-15T17:00:00.000Z"},{id:3,karyawan_id:1,karyawan:{nama:"John Doe",email:"john@afms.com"},tanggal:"2024-01-16",jam_masuk:"07:55:00",jam_keluar:null,status:"hadir",keterangan:"",lokasi_masuk:"Kantor Utama",lokasi_keluar:null,created_at:"2024-01-16T07:55:00.000Z",updated_at:"2024-01-16T07:55:00.000Z"}],l=4;async function o(a,e){try{switch(a.method){case"GET":let{page:t=1,limit:r=10,tanggal_mulai:n,tanggal_selesai:s,karyawan_id:u,status:o,cabang_id:d}=a.query,m=[...i];a.user?.role!=="admin"&&(m=m.filter(e=>e.karyawan_id===a.user?.userId)),n&&(m=m.filter(a=>a.tanggal>=n)),s&&(m=m.filter(a=>a.tanggal<=s)),u&&a.user?.role==="admin"&&(m=m.filter(a=>a.karyawan_id===parseInt(u.toString()))),o&&(m=m.filter(a=>a.status===o));let c=parseInt(t.toString()),k=parseInt(r.toString()),_=(c-1)*k,g=m.slice(_,_+k);return e.status(200).json({success:!0,data:{data:g,current_page:c,per_page:k,total:m.length,last_page:Math.ceil(m.length/k)}});case"POST":let{type:f,lokasi:p,keterangan:h}=a.body;if(!f||!["masuk","keluar"].includes(f))return e.status(400).json({success:!1,message:'Type must be either "masuk" or "keluar"'});let j=new Date().toISOString().split("T")[0],w=new Date().toTimeString().split(" ")[0];if("masuk"===f){if(i.find(e=>e.karyawan_id===a.user?.userId&&e.tanggal===j))return e.status(400).json({success:!1,message:"Already clocked in today"});let t=w>"08:00:00"?"terlambat":"hadir",r={id:l++,karyawan_id:a.user?.userId,karyawan:{nama:"Current User",email:a.user?.email},tanggal:j,jam_masuk:w,jam_keluar:null,status:t,keterangan:h||("terlambat"===t?"Terlambat":""),lokasi_masuk:p||"Unknown",lokasi_keluar:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return i.push(r),e.status(201).json({success:!0,message:"Clock in berhasil",data:r})}{let t=i.findIndex(e=>e.karyawan_id===a.user?.userId&&e.tanggal===j);if(-1===t)return e.status(400).json({success:!1,message:"No clock in record found for today"});if(i[t].jam_keluar)return e.status(400).json({success:!1,message:"Already clocked out today"});return i[t]={...i[t],jam_keluar:w,lokasi_keluar:p||"Unknown",updated_at:new Date().toISOString()},e.status(200).json({success:!0,message:"Clock out berhasil",data:i[t]})}default:return e.status(405).json({success:!1,message:"Method not allowed"})}}catch(a){return e.status(500).json({success:!1,message:"Terjadi kesalahan server",error:void 0})}}let d=Object(function(){var a=Error("Cannot find module '../../../lib/auth-middleware'");throw a.code="MODULE_NOT_FOUND",a}())(o),m=(0,u.l)(r,"default"),c=(0,u.l)(r,"config"),k=new n.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/absensi",pathname:"/api/absensi",bundlePath:"",filename:""},userland:r})},7153:(a,e)=>{var t;Object.defineProperty(e,"x",{enumerable:!0,get:function(){return t}}),function(a){a.PAGES="PAGES",a.PAGES_API="PAGES_API",a.APP_PAGE="APP_PAGE",a.APP_ROUTE="APP_ROUTE"}(t||(t={}))},1802:(a,e,t)=>{a.exports=t(145)}};var e=require("../../webpack-api-runtime.js");e.C(a);var t=e(e.s=5905);module.exports=t})();