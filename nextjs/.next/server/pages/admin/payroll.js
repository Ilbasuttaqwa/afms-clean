"use strict";(()=>{var e={};e.id=6922,e.ids=[6922],e.modules={7750:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{config:()=>u,default:()=>m,getServerSideProps:()=>g,getStaticPaths:()=>h,getStaticProps:()=>x,reportWebVitals:()=>p,routeModule:()=>b,unstable_getServerProps:()=>f,unstable_getServerSideProps:()=>N,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>j});var r=t(7093),l=t(5244),n=t(1323),i=t(7645),c=t(6814),d=t(6307),o=e([c,d]);[c,d]=o.then?(await o)():o;let m=(0,n.l)(d,"default"),x=(0,n.l)(d,"getStaticProps"),h=(0,n.l)(d,"getStaticPaths"),g=(0,n.l)(d,"getServerSideProps"),u=(0,n.l)(d,"config"),p=(0,n.l)(d,"reportWebVitals"),j=(0,n.l)(d,"unstable_getStaticProps"),v=(0,n.l)(d,"unstable_getStaticPaths"),y=(0,n.l)(d,"unstable_getStaticParams"),f=(0,n.l)(d,"unstable_getServerProps"),N=(0,n.l)(d,"unstable_getServerSideProps"),b=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/admin/payroll",pathname:"/admin/payroll",bundlePath:"",filename:""},components:{App:c.default,Document:i.default},userland:d});a()}catch(e){a(e)}})},1504:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.d(s,{z:()=>o});var r=t(997),l=t(6689),n=t(6926),i=t(9832),c=e([n]);n=(c.then?(await c)():c)[0];let d=(0,n.cva)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-primary-600 text-white hover:bg-primary-700",destructive:"bg-danger-600 text-white hover:bg-danger-700",outline:"border border-gray-300 bg-transparent hover:bg-gray-50 text-gray-700",secondary:"bg-secondary-600 text-white hover:bg-secondary-700",ghost:"hover:bg-gray-100 text-gray-700",link:"underline-offset-4 hover:underline text-primary-600",success:"bg-success-600 text-white hover:bg-success-700",warning:"bg-warning-600 text-white hover:bg-warning-700"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=(0,l.forwardRef)(({className:e,variant:s,size:t,loading:a,leftIcon:l,rightIcon:n,children:c,disabled:o,...m},x)=>(0,r.jsxs)("button",{className:(0,i.cn)(d({variant:s,size:t,className:e})),ref:x,disabled:o||a,...m,children:[a&&(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),!a&&l&&r.jsx("span",{className:"mr-2",children:l}),c,!a&&n&&r.jsx("span",{className:"ml-2",children:n})]}));o.displayName="Button",a()}catch(e){a(e)}})},8484:(e,s,t)=>{},6307:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>b});var r=t(997),l=t(6689),n=t(968),i=t.n(n),c=t(9314),d=t(1163),o=t(9948),m=t(6250),x=t(1504),h=t(9232),g=t(4449),u=t(1980),p=t(4535),j=t(1419),v=t(3952),y=t(9832),f=t(8484),N=e([m,x]);[m,x]=N.then?(await N)():N;let b=()=>{let{user:e,isAuthenticated:s,isLoading:t}=(0,c.a)(),a=(0,d.useRouter)(),{addToast:n}=(0,o.p)(),[N,b]=(0,l.useState)([]),[w,_]=(0,l.useState)(!0),[S,k]=(0,l.useState)(!1),[P,D]=(0,l.useState)(()=>{let e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`}),[M,A]=(0,l.useState)(null),[E,Z]=(0,l.useState)(!1);(0,l.useEffect)(()=>{t||s?t||!s||["admin","manager"].includes(e?.role||"")||a.push("/dasbor"):a.push("/login")},[s,t,e,a]),(0,l.useEffect)(()=>{s&&["admin","manager"].includes(e?.role||"")&&C()},[s,e,P]);let C=async()=>{try{_(!0);let e=await f.payrollApi.getDeductions(P);if(e.success)b(e.data||[]);else throw Error(e.message)}catch(e){n({type:"error",title:"Kesalahan",message:e.message||"Gagal memuat data payroll"})}finally{_(!1)}},q=async()=>{try{k(!0);let e=await f.payrollApi.processDeductions(P);if(e.success)n({type:"success",title:"Berhasil",message:e.message}),C();else throw Error(e.message)}catch(e){n({type:"error",title:"Kesalahan",message:e.message||"Gagal memproses payroll"})}finally{k(!1)}},z=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e),G=e=>{let[s,t]=e.split("-");return`${["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"][parseInt(t)-1]} ${s}`},B={totalEmployees:N.length,employeesWithDeductions:N.filter(e=>e.total_deduction>0).length,totalDeductions:N.reduce((e,s)=>e+s.total_deduction,0),totalNetSalary:N.reduce((e,s)=>e+s.net_salary,0)};return!t&&s&&["admin","manager"].includes(e?.role||"")?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i(),{children:[r.jsx("title",{children:"Payroll & Pemotongan Gaji - AFMS"}),r.jsx("meta",{name:"description",content:"Sistem payroll dan pemotongan gaji otomatis"})]}),(0,r.jsxs)(m.Z,{children:[(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-white shadow-sm rounded-lg p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Payroll & Pemotongan Gaji"}),r.jsx("p",{className:"text-gray-600 mt-1",children:"Sistem pemotongan gaji otomatis berdasarkan aturan absensi"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(h.Z,{className:"h-5 w-5 text-gray-400"}),r.jsx("select",{value:P,onChange:e=>D(e.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",children:Array.from({length:12},(e,s)=>{let t=new Date;t.setMonth(t.getMonth()-s);let a=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`;return r.jsx("option",{value:a,children:G(a)},a)})})]}),r.jsx(x.z,{onClick:q,loading:S,leftIcon:r.jsx(g.Z,{className:"h-4 w-4"}),children:"Proses Payroll"})]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"h-12 w-12 bg-primary-500 rounded-lg flex items-center justify-center",children:r.jsx(u.Z,{className:"h-6 w-6 text-white"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Karyawan"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.totalEmployees})]})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"h-12 w-12 bg-warning-500 rounded-lg flex items-center justify-center",children:r.jsx(p.Z,{className:"h-6 w-6 text-white"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Dengan Potongan"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B.employeesWithDeductions})]})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"h-12 w-12 bg-danger-500 rounded-lg flex items-center justify-center",children:r.jsx(g.Z,{className:"h-6 w-6 text-white"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Potongan"}),r.jsx("p",{className:"text-lg font-bold text-gray-900",children:z(B.totalDeductions)})]})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"h-12 w-12 bg-success-500 rounded-lg flex items-center justify-center",children:r.jsx(j.Z,{className:"h-6 w-6 text-white"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Gaji Bersih"}),r.jsx("p",{className:"text-lg font-bold text-gray-900",children:z(B.totalNetSalary)})]})]})})]}),(0,r.jsxs)("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Daftar Karyawan - ",G(P)]})}),w?r.jsx("div",{className:"p-6",children:r.jsx("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>r.jsx("div",{className:"animate-pulse",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[r.jsx("div",{className:"h-12 w-12 bg-gray-200 rounded-lg"}),(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),r.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]}),r.jsx("div",{className:"h-8 w-24 bg-gray-200 rounded"})]})},s))})}):r.jsx("div",{className:"divide-y divide-gray-200",children:N.map(e=>(0,r.jsxs)("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[r.jsx("div",{className:(0,y.cn)("h-12 w-12 rounded-lg flex items-center justify-center",e.total_deduction>0?"bg-warning-100":"bg-success-100"),children:r.jsx(u.Z,{className:(0,y.cn)("h-6 w-6",e.total_deduction>0?"text-warning-600":"text-success-600")})}),(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-lg font-medium text-gray-900",children:e.name}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 mt-1",children:[r.jsx("span",{className:"text-sm text-gray-500",children:e.jabatan}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["Gaji Pokok: ",z(e.basic_salary)]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Potongan"}),r.jsx("p",{className:(0,y.cn)("text-lg font-bold",e.total_deduction>0?"text-danger-600":"text-gray-900"),children:z(e.total_deduction)})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Gaji Bersih"}),r.jsx("p",{className:"text-lg font-bold text-success-600",children:z(e.net_salary)})]}),r.jsx(x.z,{variant:"outline",size:"sm",onClick:()=>{A(e),Z(!0)},leftIcon:r.jsx(v.Z,{className:"h-4 w-4"}),children:"Detail"})]})]}),(0,r.jsxs)("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Hadir"}),(0,r.jsxs)("p",{className:"text-lg font-semibold text-success-600",children:[e.attendance_summary.present_days,"/",e.attendance_summary.total_days]})]}),(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Terlambat"}),(0,r.jsxs)("p",{className:"text-lg font-semibold text-warning-600",children:[e.attendance_summary.late_count,"x"]})]}),(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Alpha"}),(0,r.jsxs)("p",{className:"text-lg font-semibold text-danger-600",children:[e.attendance_summary.absent_count,"x"]})]}),(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Pulang Cepat"}),(0,r.jsxs)("p",{className:"text-lg font-semibold text-warning-600",children:[e.attendance_summary.early_leave_count,"x"]})]}),(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Total Potongan"}),(0,r.jsxs)("p",{className:"text-lg font-semibold text-danger-600",children:[e.deductions.length," item"]})]})]})]},e.karyawan_id))})]})]}),E&&M&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:r.jsx("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white",children:(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Detail Pemotongan Gaji - ",M.name]}),r.jsx("button",{onClick:()=>Z(!1),className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]}),r.jsx("div",{className:"space-y-4",children:0===M.deductions.length?r.jsx("p",{className:"text-gray-500 text-center py-8",children:"Tidak ada pemotongan gaji untuk periode ini"}):M.deductions.map(e=>r.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"font-medium text-gray-900",children:e.rule_name}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),e.total_minutes&&(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Total: ",e.total_minutes," menit"]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"text-lg font-bold text-danger-600",children:["-",z(e.deduction_amount)]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[e.violation_count,"x pelanggaran"]})]})]})},e.id))}),(0,r.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"text-lg font-medium text-gray-900",children:"Total Potongan:"}),r.jsx("span",{className:"text-xl font-bold text-danger-600",children:z(M.total_deduction)})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[r.jsx("span",{className:"text-lg font-medium text-gray-900",children:"Gaji Bersih:"}),r.jsx("span",{className:"text-xl font-bold text-success-600",children:z(M.net_salary)})]})]})]})})})]})]}):r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx("div",{className:"loading-spinner w-8 h-8"})})};a()}catch(e){a(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")},9752:e=>{e.exports=import("@tanstack/react-query")},6926:e=>{e.exports=import("class-variance-authority")},9232:(e,s,t)=>{t.d(s,{Z:()=>r});var a=t(6689);let r=a.forwardRef(function({title:e,titleId:s,...t},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},t),e?a.createElement("title",{id:s},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))})},3952:(e,s,t)=>{t.d(s,{Z:()=>r});var a=t(6689);let r=a.forwardRef(function({title:e,titleId:s,...t},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},t),e?a.createElement("title",{id:s},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))})},4535:(e,s,t)=>{t.d(s,{Z:()=>r});var a=t(6689);let r=a.forwardRef(function({title:e,titleId:s,...t},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},t),e?a.createElement("title",{id:s},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))})}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[6859,8342,7890,1557],()=>t(7750));module.exports=a})();