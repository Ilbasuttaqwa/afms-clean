"use strict";(()=>{var e={};e.id=6167,e.ids=[6167],e.modules={1895:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{config:()=>g,default:()=>x,getServerSideProps:()=>h,getStaticPaths:()=>u,getStaticProps:()=>m,reportWebVitals:()=>v,routeModule:()=>N,unstable_getServerProps:()=>p,unstable_getServerSideProps:()=>f,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>b});var r=s(7093),i=s(5244),l=s(1323),n=s(7645),d=s(6814),c=s(2127),o=e([d,c]);[d,c]=o.then?(await o)():o;let x=(0,l.l)(c,"default"),m=(0,l.l)(c,"getStaticProps"),u=(0,l.l)(c,"getStaticPaths"),h=(0,l.l)(c,"getServerSideProps"),g=(0,l.l)(c,"config"),v=(0,l.l)(c,"reportWebVitals"),b=(0,l.l)(c,"unstable_getStaticProps"),j=(0,l.l)(c,"unstable_getStaticPaths"),y=(0,l.l)(c,"unstable_getStaticParams"),p=(0,l.l)(c,"unstable_getServerProps"),f=(0,l.l)(c,"unstable_getServerSideProps"),N=new r.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/admin/device-monitor-corrected",pathname:"/admin/device-monitor-corrected",bundlePath:"",filename:""},components:{App:d.default,Document:n.default},userland:c});a()}catch(e){a(e)}})},1504:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.d(t,{z:()=>o});var r=s(997),i=s(6689),l=s(6926),n=s(9832),d=e([l]);l=(d.then?(await d)():d)[0];let c=(0,l.cva)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-primary-600 text-white hover:bg-primary-700",destructive:"bg-danger-600 text-white hover:bg-danger-700",outline:"border border-gray-300 bg-transparent hover:bg-gray-50 text-gray-700",secondary:"bg-secondary-600 text-white hover:bg-secondary-700",ghost:"hover:bg-gray-100 text-gray-700",link:"underline-offset-4 hover:underline text-primary-600",success:"bg-success-600 text-white hover:bg-success-700",warning:"bg-warning-600 text-white hover:bg-warning-700"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=(0,i.forwardRef)(({className:e,variant:t,size:s,loading:a,leftIcon:i,rightIcon:l,children:d,disabled:o,...x},m)=>(0,r.jsxs)("button",{className:(0,n.cn)(c({variant:t,size:s,className:e})),ref:m,disabled:o||a,...x,children:[a&&(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),!a&&i&&r.jsx("span",{className:"mr-2",children:i}),d,!a&&l&&r.jsx("span",{className:"ml-2",children:l})]}));o.displayName="Button",a()}catch(e){a(e)}})},4230:(e,t,s)=>{s.d(t,{Z:()=>l,u:()=>i});var a=s(997);s(6689);var r=s(9832);let i=({isOpen:e,onClose:t,title:s,children:i,className:l})=>e?a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t}),(0,a.jsxs)("div",{className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl sm:max-w-lg",children:[s&&(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:s}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 focus:outline-none",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx("div",{className:(0,r.cn)("",l),children:i})]})]})}):null,l=i},2127:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{default:()=>h});var r=s(997),i=s(6689),l=s(968),n=s.n(l),d=s(1163),c=s(6250),o=s(1504),x=s(4230),m=s(9832),u=e([c,o]);[c,o]=u.then?(await u)():u;let h=()=>{let e=(0,d.useRouter)(),[t,s]=(0,i.useState)(null),[a,l]=(0,i.useState)(!0),[u,h]=(0,i.useState)(null),[g,v]=(0,i.useState)(!1),[b,j]=(0,i.useState)(!0),[y,p]=(0,i.useState)(5e3),[f,N]=(0,i.useState)(new Date);(0,i.useEffect)(()=>{if(!localStorage.getItem("token")){e.push("/login");return}},[e]);let w=(0,i.useCallback)(async()=>{try{let e=localStorage.getItem("token"),t=await fetch("/api/devices/monitor",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(t.ok){let e=await t.json();e.success&&(s(e.data),N(new Date))}}catch(e){}finally{l(!1)}},[]);(0,i.useEffect)(()=>{w()},[w]),(0,i.useEffect)(()=>{if(!b)return;let e=setInterval(()=>{w()},y);return()=>clearInterval(e)},[b,y,w]);let k=e=>{switch(e){case"online":return"bg-green-100 text-green-800 border-green-200";case"offline":default:return"bg-gray-100 text-gray-800 border-gray-200";case"error":return"bg-red-100 text-red-800 border-red-200";case"maintenance":return"bg-yellow-100 text-yellow-800 border-yellow-200"}},_=e=>{switch(e){case"online":return"\uD83D\uDFE2";case"offline":return"\uD83D\uDD34";case"error":return"⚠️";case"maintenance":return"\uD83D\uDD27";default:return"⚪"}},S=e=>{if(!e)return"Never";let t=new Date(e),s=new Date().getTime()-t.getTime(),a=Math.floor(s/6e4);return a<1?"Just now":a<60?`${a}m ago`:a<1440?`${Math.floor(a/60)}h ago`:t.toLocaleDateString()},D=e=>{h(e),v(!0)};return a?r.jsx(c.Z,{children:r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})})}):(0,r.jsxs)(c.Z,{children:[(0,r.jsxs)(n(),{children:[r.jsx("title",{children:"Device Monitor - AFMS"}),r.jsx("meta",{name:"description",content:"Real-time device monitoring"})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Device Monitor"}),r.jsx("p",{className:"text-gray-600 mt-1",children:"Real-time monitoring sistem fingerprint"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("label",{className:"text-sm text-gray-600",children:"Auto Refresh:"}),r.jsx("button",{onClick:()=>j(!b),className:(0,m.cn)("px-3 py-1 rounded text-sm font-medium transition-colors",b?"bg-green-100 text-green-800 border border-green-200":"bg-gray-100 text-gray-800 border border-gray-200"),children:b?"ON":"OFF"})]}),r.jsx(o.z,{onClick:w,className:"bg-blue-600 hover:bg-blue-700 text-white",children:"\uD83D\uDD04 Refresh"})]})]}),t&&(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[r.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t.summary.total_devices}),r.jsx("div",{className:"text-sm text-gray-600",children:"Total Devices"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.summary.online_devices}),r.jsx("div",{className:"text-sm text-gray-600",children:"Online"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[r.jsx("div",{className:"text-2xl font-bold text-gray-600",children:t.summary.offline_devices}),r.jsx("div",{className:"text-sm text-gray-600",children:"Offline"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:t.summary.error_devices}),r.jsx("div",{className:"text-sm text-gray-600",children:"Error"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[r.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:t.summary.maintenance_devices}),r.jsx("div",{className:"text-sm text-gray-600",children:"Maintenance"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.summary.total_attendance_today}),r.jsx("div",{className:"text-sm text-gray-600",children:"Attendance Today"})]})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["Last refresh: ",f.toLocaleTimeString(),b&&` (Auto refresh every ${y/1e3}s)`]}),t&&r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:t.devices.map(e=>(0,r.jsxs)("div",{onClick:()=>D(e),className:"bg-white p-4 rounded-lg shadow border hover:shadow-md transition-shadow cursor-pointer",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{className:"text-lg",children:_(e.status)}),r.jsx("span",{className:(0,m.cn)("px-2 py-1 rounded text-xs font-medium border",k(e.status)),children:e.status.toUpperCase()})]}),r.jsx("div",{className:"text-xs text-gray-500",children:e.cabang.kode_cabang})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-medium text-gray-900",children:e.nama}),r.jsx("div",{className:"text-sm text-gray-600",children:e.device_id})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,r.jsxs)("div",{children:["\uD83D\uDCCD ",e.lokasi]}),(0,r.jsxs)("div",{children:["\uD83C\uDF10 ",e.ip_address,":",e.port]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Attendance Today:"}),r.jsx("span",{className:"font-medium",children:e.today_attendance_count})]}),e.temperature&&(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Temperature:"}),(0,r.jsxs)("span",{className:(0,m.cn)("font-medium",e.temperature>70?"text-red-600":"text-green-600"),children:[e.temperature,"\xb0C"]})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 pt-2 border-t",children:["Last sync: ",S(e.last_sync)]})]})]},e.id))}),r.jsx(x.u,{isOpen:g,onClose:()=>v(!1),title:`Device Details - ${u?.nama}`,children:u&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Device ID"}),r.jsx("div",{className:"text-sm text-gray-900",children:u.device_id})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),r.jsx("span",{className:(0,m.cn)("inline-flex px-2 py-1 rounded text-xs font-medium border",k(u.status)),children:u.status.toUpperCase()})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Branch"}),r.jsx("div",{className:"text-sm text-gray-900",children:u.cabang.nama_cabang})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Location"}),r.jsx("div",{className:"text-sm text-gray-900",children:u.lokasi})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"IP Address"}),(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[u.ip_address,":",u.port]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Firmware"}),r.jsx("div",{className:"text-sm text-gray-900",children:u.firmware_version||"Unknown"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Employee Count"}),r.jsx("div",{className:"text-sm text-gray-900",children:u.employee_count})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Storage Usage"}),(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[u.storage_usage,"%"]})]}),u.temperature&&(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Temperature"}),(0,r.jsxs)("div",{className:(0,m.cn)("text-sm font-medium",u.temperature>70?"text-red-600":"text-green-600"),children:[u.temperature,"\xb0C"]})]}),u.memory_usage&&(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Memory Usage"}),(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[u.memory_usage,"%"]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Today Attendance"}),r.jsx("div",{className:"text-sm text-gray-900",children:u.today_attendance_count})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total Attendance"}),r.jsx("div",{className:"text-sm text-gray-900",children:u.total_attendance_count})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Sync"}),r.jsx("div",{className:"text-sm text-gray-900",children:S(u.last_sync)})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created"}),r.jsx("div",{className:"text-sm text-gray-900",children:new Date(u.created_at).toLocaleString()})]})]}),u.error_message&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[r.jsx("label",{className:"block text-sm font-medium text-red-700",children:"Error Message"}),r.jsx("div",{className:"text-sm text-red-600",children:u.error_message})]}),r.jsx("div",{className:"flex justify-end space-x-2 pt-4",children:r.jsx(o.z,{onClick:()=>v(!1),className:"bg-gray-500 hover:bg-gray-600 text-white",children:"Close"})})]})})]})]})};a()}catch(e){a(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")},9752:e=>{e.exports=import("@tanstack/react-query")},6926:e=>{e.exports=import("class-variance-authority")}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[6859,8342,7890,1557],()=>s(1895));module.exports=a})();